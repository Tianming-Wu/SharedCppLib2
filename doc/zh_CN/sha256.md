# sha256 - SHA256 哈希算法库

+ 名称: sha256  
+ 命名空间: `sha256`  
+ 文档版本: `1.0.0`

## CMake 配置信息

| 项目 | 值 |
|---------|---------|
| 命名空间 | `SharedCppLib2` |
| 库名称 | `sha256` |

包含方式:
```cmake
find_package(SharedCppLib2 REQUIRED)
target_link_libraries(target SharedCppLib2::sha256)
```

## 描述

SHA256 库提供了 SHA-256 加密哈希函数（FIPS 180-4）的实现。它生成 256 位（32 字节）的哈希值，通常表示为 64 位十六进制数字。该库适用于数据完整性验证、数字签名和加密应用。

## 快速开始

### 基本文件哈希计算
```cpp
#include <SharedCppLib2/sha256.hpp>
#include <SharedCppLib2/bytearray.hpp>
#include <fstream>

int main() {
    std::ifstream ifs("file.txt", std::ios::binary);
    std::bytearray file_data;
    file_data.readAllFromStream(ifs);
    
    std::bytearray hash = sha256::getMessageDigest(file_data);
    std::cout << "SHA256: " << hash.tohex() << std::endl;
    
    return 0;
}
```

### 字符串哈希计算
```cpp
#include <SharedCppLib2/sha256.hpp>

std::string text = "Hello World";
std::string hex_hash = sha256::getHexMessageDigest(text);
std::cout << "哈希值: " << hex_hash << std::endl;
```

## 核心函数

### encrypt
```cpp
bool encrypt(const std::bytearray& message, std::bytearray* _digest);
```
计算输入消息的 SHA256 哈希值。

**参数:**
- `message`: 要哈希的输入数据
- `_digest`: 输出参数，用于接收结果哈希（32 字节）

**返回值:** 成功返回 `true`，错误返回 `false`

**示例:**
```cpp
std::bytearray data = "Hello World";
std::bytearray hash;
if (sha256::encrypt(data, &hash)) {
    std::cout << "哈希值: " << hash.tohex() << std::endl;
}
```

### getHexMessageDigest
```cpp
std::string getHexMessageDigest(const std::string& message);
```
计算字符串的 SHA256 哈希值并返回十六进制表示。

**参数:**
- `message`: 要哈希的输入字符串

**返回值:** 64 字符的十六进制哈希字符串

**示例:**
```cpp
std::string hash = sha256::getHexMessageDigest("password123");
// 返回: "ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
```

### getMessageDigest
```cpp
std::bytearray getMessageDigest(std::bytearray message);
```
计算字节数组数据的 SHA256 哈希值。

**参数:**
- `message`: 要哈希的输入字节数组

**返回值:** 包含 32 字节哈希值的字节数组

**示例:**
```cpp
std::bytearray data = {std::byte{0x48}, std::byte{0x65}, std::byte{0x6c}, std::byte{0x6c}, std::byte{0x6f}};
std::bytearray hash = sha256::getMessageDigest(data);
std::cout << hash.tohex() << std::endl;
```

## 算法细节

SHA256 实现遵循标准规范：

1. **预处理**: 填充和附加长度值
2. **块处理**: 将数据分解为 512 位（64 字节）块
3. **消息调度**: 将块扩展为 64 个 32 位字
4. **压缩**: 使用 SHA256 常量进行 64 轮变换
5. **最终处理**: 生成 256 位摘要

### 使用的常量
- **初始哈希值**: 前 8 个质数的平方根小数部分
- **轮常量**: 前 64 个质数的立方根小数部分

## 性能说明

- 以 512 位块处理数据
- 通过流处理适合大文件
- 纯 C++ 实现，无外部依赖

## 常见使用场景

### 文件完整性验证
```cpp
bool verify_file_integrity(const std::string& filename, const std::string& expected_hash) {
    std::ifstream file(filename, std::ios::binary);
    std::bytearray content;
    content.readAllFromStream(file);
    
    std::string actual_hash = sha256::getMessageDigest(content).tohex();
    return actual_hash == expected_hash;
}
```

### 密码哈希
```cpp
std::string hash_password(const std::string& password) {
    return sha256::getHexMessageDigest(password);
}
```

### 数据比较
```cpp
bool compare_data(const std::bytearray& data1, const std::bytearray& data2) {
    return sha256::getMessageDigest(data1) == sha256::getMessageDigest(data2);
}
```